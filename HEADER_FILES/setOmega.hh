/*
In this function, we will initialize the omega fields
*/
void setOmega( ){

  int i, j, chain,ii,jj;
  double epsln=0.1;
  double p_ABC, p_DE, p_F;

  
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  std::ifstream infile;
  if(NBox==32){
    if(Bilayer==1){infile.open("./OMEGA/READ/phi_bilayer_32_32.dat");}
    if(Pore==1){infile.open("./OMEGA/READ/phi_pore_32_32.dat");}
  }else if(NBox==50){
    if(Bilayer==1){infile.open("./OMEGA/READ/omega_bilayer_50_50.dat");}
    if(Pore==1){infile.open("./OMEGA/READ/omega_pore_50_50.dat");}
  }
  for(i=0;i<NBox;i++){
    for(j=0;j<NBox;j++){
      infile >> phi[0][i][j] >> phi[1][i][j] >> phi[2][i][j] >> phi[3][i][j] >> phi[4][i][j] >> phi[5][i][j];
    }
  }
  infile.close();
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  


  /*
  if(Bilayer==1){
    for(i=0;i<NBox;i++){
      for(j=0;j<NBox;j++){
	phi[0][i][j]=0.0;
	phi[1][i][j]=0.0;
	phi[2][i][j]=0.0;
	phi[3][i][j]=0.0;
	phi[4][i][j]=0.0;
	phi[5][i][j]=1.0;
      }
    }
    for(i=0;i<NBox;i++){
      for(j=((NBox/2)-3);j<((NBox/2)+3);j++){
	phi[4][i][j]=1.0;
	phi[5][i][j]=0.0;
      }
    }
  }else if(Pore==1){
    for(i=0;i<NBox;i++){
      for(j=0;j<NBox;j++){
	phi[0][i][j]=0.0;
	phi[1][i][j]=0.0;
	phi[2][i][j]=0.0;
	phi[3][i][j]=0.0;
	phi[4][i][j]=0.0;
	phi[5][i][j]=1.0;
      }
    }
    for(i=NBox/2;i<NBox;i++){
      for(j=((NBox/2)-3);j<((NBox/2)+3);j++){
	phi[4][i][j]=1.0;
	phi[5][i][j]=0.0;
      }
    }
  }
  */

  
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  for(i=0;i<NBox;i++){
    for(j=0;j<NBox;j++){
      for(ii=0;ii<ChainType;ii++){
	cal_w[ii][i][j]=0.0;
	for(jj=0;jj<ChainType;jj++){  
	  w[ii][i][j]+=chiMatrix[ii][jj]*phi[jj][i][j];
	}
      }
    }
  }
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  
  return;

};


















 
